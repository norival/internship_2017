---
title: Estimation abondances
date:
author:
output: ioslides_presentation
---

```{r, loading_data, echo=FALSE}
library(ggplot2)
library(magrittr)
library(dplyr)
load('/tmp/data_verif.RData')
```

## Problématique

Jusqu'où peut-on dégrader la précision des relevés tout en gardant une bonne
estimation des abondances réelles ?

### Méthode

- Les données 2013 possèdent des relevés d'abondances complètes
- Dégradation des abondances en relevés 0/1, $log_2$ ou $log_{10}$
- Estimation par la moyenne géométrique pour les relevés $log_{10}$
- Estimation par une loi de Poisson composée pour les relevés $log_2$
- Estimation par une loi de Poisson simple pour les relevés 0/1


## Moyenne géométrique Vs. abondance

```{r, graphgeom, echo=FALSE}
cor_gmean %>%
  ggplot(aes(y = real, x = estimate)) +
  geom_point(size = 2, shape = 1) +
  theme_bw() +
  ylab("Densité réelle") +
  xlab("Moyenne géométrique") +
  geom_abline(slope = 1, intercept = 0)
```

## Moyenne géométrique Vs. abondance (log)

```{r, graphgeomlog, echo=FALSE}
cor_gmean %>%
  ggplot(aes(y = log(real), x = log(estimate))) +
  geom_point(size = 2, shape = 1) +
  theme_bw() +
  ylab("log(Densité réelle)") +
  xlab("log(Moyenne géométrique)") +
  geom_abline(slope = 1, intercept = 0)
```

## Estimations $log_2$

```{r, graphbase22log, echo=FALSE}
cor_base2[, 1:4] %>%
  filter(estimate < 80) %>%
  ggplot(aes(y = real, x = estimate)) +
  geom_point(size = 2, shape = 1) +
  theme_bw() +
  ylab("Densité réelle") +
  xlab("Estimation sur base2") +
  geom_abline(slope = 1, intercept = 0)
```

## Estimations $log_2$ (log)

```{r, graphbase22, echo=FALSE}
cor_base2[, 1:4] %>%
  filter(estimate < 80) %>%
  ggplot(aes(y = log(real), x = log(estimate))) +
  geom_point(size = 2, shape = 1) +
  theme_bw() +
  ylab("log(Densité réelle)") +
  xlab("log(Estimation sur base2)") +
  geom_abline(slope = 1, intercept = 0)
```

---

```{r, densities, echo=FALSE, fig.height=6.2}
bb %>%
  ggplot(aes(ab)) +
  geom_histogram(bins = 30) +
  facet_wrap(~ parc) +
  theme_bw()
```

## Estimation 0/1

```{r, graphbase10, echo=FALSE}
suppressWarnings({
cor_base0 %>%
  ggplot(aes(y = real, x = estimate)) +
  geom_point(size = 2, shape = 1) +
  theme_bw() +
  ylab("Densité réelle") +
  xlab("Estimation sur 0/1") +
  geom_abline(slope = 1, intercept = 0)
})
```

## Estimation 0/1 (log)

```{r, graphbase10log, echo=FALSE}
suppressWarnings({
cor_base0 %>%
  ggplot(aes(y = log(real), x = log(estimate))) +
  geom_point(size = 2, shape = 1) +
  theme_bw() +
  # scale_x_continuous(limits = c(0, 30)) +
  # scale_y_continuous(limits = c(0, 30)) +
  ylab("log(Densité réelle)") +
  xlab("log(Estimation sur 0/1)") +
  geom_abline(slope = 1, intercept = 0)
})
```

## Relation directe base 2

```{r, emp2, echo=FALSE}
plot(b2, a)
```

## Relation directe base 10

```{r, emp10, echo=FALSE}
plot(b10, a)
```

## Relation directe 0/1

```{r, emp0, echo=FALSE}
plot(b0, a)
```
